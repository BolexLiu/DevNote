![](http://upload-images.jianshu.io/upload_images/1110736-7864e42a7f26ed3a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/720)



**ä¸ºä»€ä¹ˆè¦é€†å‘romå±‚ï¼Ÿ**
 å…ˆè§£é‡Šä¸‹æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦è¿™æ ·åšå§ï¼Œ`Android`çš„ç¢ç‰‡åŒ–ä¸ç”¨æˆ‘è¯´å¤§å®¶éƒ½æ‡‚çš„ï¼Œäº”èŠ±å…«é—¨ã€‚æ—¶å¸¸åº”ç”¨å±‚å¼€å‘è€…ç—›ä¸æ¬²ç”Ÿï¼Œæ˜æ˜åœ¨æˆ‘è¿™é‡Œå¼€å‘æ—¶è¿è¡Œæ²¡æœ‰é—®é¢˜ï¼Œtmçš„ä¸€ä¸Šçº¿å°±å‡ºé—®é¢˜ã€‚ä¸ºä»€ä¹ˆï¼Ÿè¿™ä¸ªæœºå‹`rom`è¢«æ”¹åŠ¨äº†å‘€ã€‚çœŸå¥½çƒ¦å“¦ã€‚è¿™ç§è¯´bugåˆä¸æ˜¯bugï¼Œä½†ç¡®å®åˆæ˜¯bugçš„é—®é¢˜è¿˜å¾—ä½ ä¿®ã€‚ç‰¹åˆ«æ˜¯æŸäº›å°å…¬å¸æ¡ä»¶é™åˆ¶æ²¡èƒ½åŠ›ä¹°é½å…¨ä¸»æµçš„æœºå‹ä¾›å¼€å‘äººå‘˜å·¥ä½œä½¿ç”¨ã€‚ï¼ˆ**æƒ³è¦çŒªå„¿è‚¥åˆå£®ï¼Œå…‰åƒè‰ï¼Œè¿˜ä¸ç»™å–‚é¥±ï¼ï¼ï¼**ï¼‰è€Œä½ è¿˜å¾—é»˜é»˜çš„ç»™é€‚é…å¥½ï¼Œæ€ä¹ˆåŠï¼ŸåŠæ³•ä¹Ÿä¸æ˜¯æ²¡æœ‰ï¼Œä¸šç•Œå†…æˆ‘åœ¨ç½‘ä¸Šèµ„æ–™æŸ¥æ‰¾å°‘åˆå…¬å¼€è¿™ä¸ªæ€è·¯ï¼Œä¸è¿‡æˆ‘è§‰å¾—å¦‚æœèƒ½é€†å‘ä¸€æŠŠå‚å•†çš„`rom`ï¼Œï¼ˆä¼°è®¡å¤§å‚çš„çˆ±paipaié€‚é…åº”è¯¥ä¹Ÿä¼šè¿™æ ·åšï¼Œå› ä¸ºæˆ‘æ²¡æœ‰åœ¨å¤§å‚å¾…è¿‡å‘€ã€‚æ‰€ä»¥åªèƒ½ä¼°è®¡äº†ã€‚ï¼‰çœ‹çœ‹`rom`å‚å•†çš„å®ç°æ€ä¹ˆå†™çš„ï¼Œéš¾é“è¿˜ä¸èƒ½é€‚é…å¥½äº†å˜›ï¼æ‰€ä»¥å°±æœ‰äº†ä¸‹æ–‡ã€‚

è¿™ç¯‡æ–‡ç« æ‹–äº†å¾ˆä¹…ï¼Œå¤§çº²æˆ‘æ˜¯ä¸€ä¸ªæœˆå‰å†™å¥½çš„ï¼Œä¸€ç›´æ²¡æ¥å¾—åŠå¡«å……å†…å®¹ã€‚ç½ªè¿‡ï¼Œé†‰è¿‡ï¼~ å·¥ä½œä¸Šå®åœ¨æŠ½ä¸å‡ºæ—¶é—´äº†ï¼Œä¸€å›å®¶å€’åºŠå°±è¿·è¿·ç³Šç³Šç¡ç€äº†ã€‚åé¢æœ‰åŒå­¦é—®æˆ‘è¯´:"ä½ å’‹è¿˜æ²¡å‘å¸ƒï¼Ÿé‚£ä¸ªé€†å‘é€‚é…çš„ï¼Œæˆ‘ç­‰ç€æ‰“èµä¸€æ³¢å‘¢ã€‚â€å¬å®Œè¿™å¥è¯ï¼Œæˆ‘åˆå¿ä¸ä½æˆ‘çš„éº’éºŸè‡‚ã€‚ä¹˜ç€å‘¨æœ«ï¼Œæ¥ï¼Œå¿«æ‰¶è€å¤«èµ·æ¥ï¼Œå¼€æ•´ã€‚

ä¸ºäº†èƒ½ä¿è¯åé¢çœ‹æ–‡ç« çš„åŒå­¦èƒ½å¤Ÿé¡ºåˆ©è·Ÿç€æœ¬æ–‡å»å®è·µï¼Œæˆ‘æ¸…ç©ºäº†ç”µè„‘ä¸Šå·²æœ‰æ‰€æœ‰åç¼–è¯‘å·¥å…·ç¯å¢ƒï¼Œä»å¤´æ¥è¿‡ä¸€éï¼Œï¼ˆå…¶å®å°±æ˜¯ä»å¤´å†è¸©ä¸€éå‘å•¦ã€‚ç»éªŒå‘Šè¯‰æˆ‘ä»¬ï¼Œåšè¿™ç§äº‹æƒ…ï¼Œä»æ¥å°±ä¸ä¼šé‚£ä¹ˆé¡ºåˆ©ã€‚(â”¬ï¼¿â”¬)å“­~ï¼‰å·²å°½é‡ä¿è¯æœ¬ç« åœ¨å†™ä½œçš„è¿‡ç¨‹ä¸­ä¸ä¼šå‡ºç°ç–æ¼è€Œå¯¼è‡´çš„å¤§å®¶æ‰å‘é‡Œäº†ï¼Œä½†æ˜¯ä¸å¯é¿å…è¿˜æ˜¯å¯èƒ½ä¼šç–å¿½ç¬”è¯¯ä¹‹ç±»çš„ï¼Œé‚£ä¹ˆå¤§å®¶å¯ä»¥ç»™æˆ‘ç•™è¨€ï¼Œå¯èƒ½å›å¤æ…¢ä¸€ç‚¹ï¼Œä½†æ˜¯ä¸€å®šä¼šè®¤çœŸå›ç­”çš„ã€‚

 æ„Ÿè°¢ç™½æ‰‹ã€è¿½é£917ã€imesong æä¾›çš„å¸®åŠ©ï¼Œè°¢è°¢ ã€‚è¿˜æœ‰æ—å­¦æ£®å¤§å¤§çš„ä¸€æœ¬ä¹¦æ¨èã€Šæ·±å…¥ç†è§£ Android å†…æ ¸è®¾è®¡æ€æƒ³ã€‹ï¼Œå¯¹æœ¬ç¯‡æ–‡ç« æä¾›äº†å­¦ä¹ å‚è€ƒã€‚

**æ¸©é¦¨æç¤ºï¼šå‰æ–¹é•¿ç¯‡é¢„è­¦ï¼Œçœ‹ä¸å®Œï¼Œåˆè§‰å¾—ç²¾å½©çš„æ—¶å€™ã€‚æ”¶è—ä¸€ä¸‹ç‚¹ä¸ªå–œæ¬¢å§ã€‚å’±ä»¬æ…¢æ…¢æ¥å“ˆã€‚**

-----

# ç›®å½•
- åŸºç¡€çŸ¥è¯†
  - dex
  - odex
  - smali

- romå±‚åº”ç”¨åˆ†æ
  - odexä¸apk
  - æ¡†æ¶æ–‡ä»¶

- é€†å‘å·¥å…·ç®±
  - baksmali
  - dex2jar
  - apktools
  - gd-gui
  - SVADeodexerForArt
  - apkDB

  - å½“å‰Activity


- å®æˆ˜é€†å‘MIUIç³»ç»Ÿè®¾ç½®WIFI
  - éœ€æ±‚
  - æ€è·¯
  - å¯»æ‰¾åˆ‡å…¥ç‚¹
  - ä¸‹è½½å›ºä»¶
  - æ‹†åŒ…ä¸åˆå¹¶èµ„æº
  - ç¿»æºç 
  - åå°„API


----

## åŸºç¡€çŸ¥è¯†

åŸºç¡€è¿™éƒ¨åˆ†ç‰¹åˆ«é‡è¦ï¼Œå¦‚æœä¸æ˜¯å¾ˆæ‰å®åŒå­¦ä¸€å®šè¦è®¤çœŸå­¦ä¹ å™¢ã€‚ç†Ÿæ‚‰çš„åŒå­¦å°±å¾€åè·³ç€çœ‹å§ï¼Œä¸ºäº†ç…§é¡¾å¤§å¤šæ•°åŒå­¦ï¼Œè¿™éƒ¨åˆ†å°±ä¸èƒ½ä¸¢äº†ã€‚

- dex

`dex`å¤§å®¶åº”è¯¥ä¸ä¼šé™Œç”Ÿï¼Œæˆ‘ä»¬å¹³æ—¶å†™çš„ç±»éƒ½ä¼šè¢«è½¬æ¢æˆ`class`ç„¶åæ‰“åŒ…æˆ`dex`ã€‚ä½ å¯ä»¥å°è¯•è§£å‹ç¼©ä½ çš„`apk`æ–‡ä»¶æŸ¥çœ‹ã€‚

ä¹Ÿå¯ä»¥ä¸‹é¢çš„æ–¹å¼è½¬æ¢`java`ç±»ç›´æ¥è½¬æ¢æˆ`dex`ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š

>1.`javac xxx.java  ` ï¼ˆå¾—åˆ°>>> `xxx.class`æ–‡ä»¶ï¼‰
2.é…ç½®ç¯å¢ƒå˜é‡ Android SDKå¼€å‘åŒ…ä¸‹çš„dxå·¥å…· ï¼ˆè·¯å¾„:`/build-tools/ç¼–è¯‘ç‰ˆæœ¬/dx` ï¼‰
3.`dx --dex --output=xxx.dex xxx.class`  ï¼ˆå¾—åˆ°>>> `xxx.dex`æ–‡ä»¶ï¼‰

è¿™æ ·å¾—åˆ°çš„dexæ˜¯å¯ä»¥ç›´æ¥ç”¨Androidè™šæ‹Ÿæœºæ‰§è¡Œçš„ï¼Œå¯ä»¥ä½¿ç”¨`adb shell`è¿›å…¥å¹¶è¾“å…¥` # dalvikvm -cp /sdcard/name.dex name` å¯ç›´æ¥è¿è¡Œã€‚

- odex

`odex???`,æ²¡æ¯›ç—…ã€‚ç”¨ç™¾åº¦ç™¾ç§‘åŸè¯è¯´ï¼š

>`ODEX`æ˜¯å®‰å“ä¸Šçš„åº”ç”¨ç¨‹åº`apk`ä¸­æå–å‡ºæ¥çš„å¯è¿è¡Œæ–‡ä»¶ï¼Œå³å°†APKä¸­çš„`classes.dex`æ–‡ä»¶é€šè¿‡`dex`ä¼˜åŒ–è¿‡ç¨‹å°†å…¶ä¼˜åŒ–ç”Ÿæˆä¸€ä¸ª`dex`æ–‡ä»¶å•ç‹¬å­˜æ”¾ã€‚

å¦‚æœç»å¸¸åˆ·æœºçš„æœ‹å‹è‚¯å®šä¸ä¼šé™Œç”Ÿï¼Œç»å¸¸æœ‰æ°‘é—´`rom`ä½œè€…è¯´å·²ä¼˜åŒ–`odex`ã€‚é‚£ä¹ˆå…¶å®ä»–å°±æ˜¯æŠŠ`apk`åŒ…ä¸­çš„`dex`æå–å‡ºæ¥è½¬æˆ`odex`ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸ºä»€ä¹ˆè¯´æ˜¯ä¼˜åŒ–å‘¢ï¼Ÿå› ä¸ºåœ¨ `4.4ART`è™šæ‹Ÿæœºä¹‹å‰ï¼Œ`DVM`è™šæ‹Ÿæœºæ¯æ¬¡æ‰“å¼€ä¸€ä¸ªåº”ç”¨ç¨‹åºå‰éƒ½éœ€è¦å…ˆè§£å‹ç¼©åŒ…ï¼Œç„¶åæ€é¸¡å–åµçš„æ‹¿åˆ°`dex`å†è¯»åˆ°è™šæ‹Ÿæœºå†…ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­è§£å‹æ˜¯è¦èŠ±æ—¶é—´çš„ã€‚ä¸ºäº†è®©å¼€æœºå’Œå¯åŠ¨åº”ç”¨é€Ÿåº¦åŠ å¿«ã€‚å°†`apk`ä¸­çš„`dex`æå‰å–å‡ºæ¥å°±çœå»äº†è§£å‹çš„è€—æ—¶ã€‚ç¬¬äºŒä¸€ä¸ªä»¥å‰å¾ˆè€çš„æœºå™¨å¾€å¾€å¯ä¾›ç³»ç»Ÿç”¨çš„å­˜å‚¨ç©ºé—´ä¸å¤Ÿå¤§ï¼Œå¸¸è§„çš„åšæ³•é™¤äº†æå‰æ‹¿åˆ°`odex`ä»¥å¤–ï¼Œè¿˜ä¼šæŠŠ`apk`åŒ…ä¸­`dex`åˆ é™¤æ‰ï¼Œå·²èŠ‚çº¦ç©ºé—´ã€‚ä¸å¾—ä¸è¯´`rom`å·¥ç¨‹å¸ˆéƒ½æ˜¯åœ¨ç»å°½è„‘æ±çš„åšä¼˜åŒ–ã€‚ä¹Ÿè®¸å°±æ˜¯åªä¸ºæå‡é‚£0.1ç§’çš„æ—¶é—´å§ï¼Œä¹Ÿè¦ä¸æŠ˜æ‰‹æ®µåšåˆ°æè‡´ã€‚

- smali

smaliæ˜¯è™šæ‹ŸæœºæŒ‡ä»¤è¯­è¨€ï¼Œæ˜¯ç»™è™šæ‹Ÿæœºçœ‹çš„ã€‚æˆ‘ä»¬å¦‚æœæŠŠdexæ–‡ä»¶åç¼–è¯‘åå°±å¯ä»¥çœ‹åˆ°ã€‚é‡Œé¢çš„æŒ‡ä»¤é›†ï¼Œè¯»è€…æ— éœ€æ·±ç©¶è¿™éƒ¨åˆ†çš„æŒ‡ä»¤é›†ã€‚æœ¬ç¯‡ä¹Ÿä¸æ¶‰åŠè¿™äº›å†…å®¹ã€‚æˆ‘ä»¬äº†è§£ä¸ªå¤§æ¦‚å°±è¡Œäº†ã€‚è¿™äº›å·¥ä½œå°±ç•™ç»™ä¸“é—¨çš„åç¼–è¯‘å·¥ä½œè€…å§ã€‚ï¼ˆä½ è¦æ·±å…¥å­¦ï¼Œä¹Ÿæ²¡äººä¼šæ‹¦ç€ä½ çš„ã€‚å“ˆå“ˆï¼‰

å¥½ï¼Œè¿™é‡Œæˆ‘ä»¬äº†è§£äº†ä¸‰ä¸ªåŸºç¡€çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹ã€‚
**`dexã€ odexã€smali`**
æˆ‘ä»¬è„‘å­é‡Œè¿‡ä¸€ä¸‹ï¼Œæœ‰ä¸ªæ˜ åƒçŸ¥é“å®ƒä»¬éƒ½æ˜¯å¹²å˜›çš„å°±å¯ä»¥äº†ã€‚ä¸‹é¢æˆ‘ä»¬å°±è¿›å…¥`rom`å±‚çš„é€†å‘æµç¨‹ï¼Œå¹²è´§æ¥äº†ï¼Œå‡†å¤‡å¥½å“¦ã€‚

-----

## romå±‚åº”ç”¨åˆ†æ

**æç¤ºï¼š**æœ¬ç« åªæ˜¯åœ¨ç²—ç³™çš„åˆ†æç³»ç»Ÿåº”ç”¨ç»“æ„ï¼Œä¸æ¶‰åŠä»`rom`åŒ…ä¸‹è½½åˆ°è§£å‹å’Œæ‰¾åº”ç”¨è·¯å¾„çš„æ¥é¾™å»è„‰ï¼Œåœ¨åé¢çš„å®æˆ˜ç« èŠ‚ä¸­ä¼šç»†ç»†è®²è§£ï¼Œè¯»è€…æ— éœ€çº ç»“ä¸‹é¢è¦è®²åˆ°çš„appä»å“ªé‡Œå˜å‡ºæ¥çš„ã€‚ï¼ˆé—®é¢˜æ˜¯æˆ‘ä¹Ÿå˜ä¸å‡ºæ¥å‘€ã€‚QAQï¼‰

- odexä¸apk
ä¸ºä»€ä¹ˆ`apk`è¦å’Œ`odex`åˆå¹¶ï¼Ÿå‰é¢æˆ‘ä»¬åœ¨ä¸Šä»¥ä¸€ä¸ªåŸºç¡€ç¯‡ç« èŠ‚è®²è¿‡ï¼Œ`odex`çš„ä¼˜åŒ–ã€‚`rom`å‚å•†çš„ä¼šæŠŠ`app`æŠŠç³»ç»Ÿçº§åˆ«çš„`App`çš„æºç å’Œèµ„æºæ–‡ä»¶åšåˆ†ç¦»ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€å¹…å›¾ã€‚

![](http://upload-images.jianshu.io/upload_images/1110736-8e0d455022210de1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

ä¸Šé¢è¿™å¹…å›¾å·¦è¾¹æ˜¯å¸¸è§„APPï¼Œå³è¾¹æ˜¯å°ç±³SettingsAPPã€‚å¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°Settingsé‡Œé¢æ²¡æœ‰`classes.dex`æ–‡ä»¶ã€‚å¦‚æœæŒ‰ç…§å¾€å¸¸åº”ç”¨å±‚æ‰“åŒ…å‘å¸ƒapkçš„æ€è·¯èµ°ã€‚apkå†…è‡³å°‘ä¼šæœ‰ä¸€ä¸ª`classes.dex`ã€‚ï¼ˆdexåˆ†åŒ…ä¼šæœ‰å¤šä¸ªï¼‰
è€Œæˆ‘ä»¬çŸ¥é“ä¸€ä¸ªappé‡Œçš„æºç å°±åœ¨dexé‡Œï¼Œå¦‚æœç”¨å¸¸è§„çš„åº”ç”¨å±‚åç¼–è¯‘å»åç¼–è¯‘åˆ™ä»€ä¹ˆéƒ½çœ‹ä¸åˆ°ï¼Œè¿˜ä¼šå¯¼è‡´ä¸€äº›åç¼–è¯‘å·¥å…·æŠ›å‡ºæ— æ³•æ‰¾åˆ°dexçš„å¼‚å¸¸ã€‚è¿™ä¸ªé—®é¢˜å…ˆæ”¾åˆ°è¿™é‡Œã€‚

æˆ‘ä»¬å†çœ‹å¦ä¸€é™„å›¾ï¼š

![](http://upload-images.jianshu.io/upload_images/1110736-3b25c7242b2a8b7f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

è€å¸æœºå¯èƒ½ä¸€çœ¼å°±çœ‹åˆ°äº†è¿™ä¸ªç›®å½•éåŒå¯»å¸¸ï¼Œæ²¡é”™ï¼Œæ­£æ˜¯MIUIçš„`rom`è§£å‹ç¼©åçš„ç›®å½•ã€‚å…¶ä¸­`\system\priv-app\Settings`æ˜¯ç³»ç»Ÿè®¾ç½®åº”ç”¨çš„è·¯å¾„ã€‚æˆ‘ä»¬å‘ç°å…¶ä¸­æœ‰ä¸€ä¸ª`oat\arm`ç›®å½•æ‰“å¼€åå¯ä»¥å‘ç°é‡Œé¢æœ‰ä¸€ä¸ªSettings.odexæ–‡ä»¶ã€‚è€Œè¿™ä¸ªæ–‡ä»¶æ­£æ˜¯`Settings.app`çš„æºç æ–‡ä»¶ã€‚

- æ¡†æ¶æ–‡ä»¶
å¾€å¸¸æˆ‘ä»¬çš„apkä¸­ä¼šåŒ…å«ä¸€ä¸ª`Resources.arsc`æ–‡ä»¶ï¼Œç®€å•æ¥è¯´å®ƒæ˜¯Appçš„èµ„æºæ–‡ä»¶ç´¢å¼•è¡¨ï¼ŒåŒ…æ‹¬xmlã€å›¾ç‰‡ã€æ–‡ä»¶ç­‰ç´¢å¼•éƒ½è¢«å­˜åœ¨å†…ã€‚è€Œç³»ç»Ÿåº”ç”¨é™¤äº†åœ¨`Resources.arsc`æœ‰ç´¢å¼•ï¼Œè¿˜ä¼šè·Ÿframeworkçš„èµ„æºäº§ç”Ÿå…³è”ã€‚ç”±äºæˆ‘ä¸æ˜¯åš`framework`å±‚å¼€å‘çš„ï¼Œå¯èƒ½å­˜è¯¯åŒºï¼Œæ¬¢è¿å„ä½æŒ‡æ­£ã€‚

æ¡†æ¶æ–‡ä»¶æ˜¯æŒ‡`frameworkçš„framework.apkã€core.jar`æ–‡ä»¶ç­‰ã€‚åœ¨åç¼–è¯‘ç³»ç»Ÿåº”ç”¨æ—¶å¿…é¡»è¦å€ŸåŠ©ä»–ä»¬åšèµ„æºæ˜ å°„ã€‚


![](http://upload-images.jianshu.io/upload_images/1110736-42b3a996cc17db91.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

![](http://upload-images.jianshu.io/upload_images/1110736-4a7c9babe27c42fe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

romå±‚å¯¹ç³»ç»Ÿåº”ç”¨è¿›è¡Œäº†`odex`ä¼˜åŒ–ï¼Œå…¶ä¸­å°±åŒ…æ‹¬äº†èµ„æºæ–‡ä»¶çš„ä¾èµ–ï¼Œæœ‰ä¸€éƒ¨åˆ†æ˜¯å­˜æ”¾åœ¨`framework.apkã€core.jar`ç­‰ã€‚å¹¶ä¸åƒæˆ‘ä»¬å¹³æ—¶å¼€å‘appçš„æ—¶å€™åªå­˜åœ¨äº`Resources.arsc`æ–‡ä»¶ä¸­ã€‚ä¸è¿‡å› ä¸ºå‚å•†å’Œç³»ç»Ÿç‰ˆæœ¬ä¸åŒï¼Œå®ƒä»¬çš„åç§°å¯èƒ½ä¹Ÿæœ‰ç‚¹å·®åˆ«ï¼Œæ²¡æœ‰å…³ç³»ã€‚æ€»ä¹‹æˆ‘ä»¬åé¢ä¸ç®¡æ˜¯åˆå¹¶odexå’Œapkçš„æ—¶å€™ï¼Œæˆ–è€…åç¼–è¯‘æºç çš„æ—¶å€™å°±éœ€è¦ä½¿ç”¨åˆ°å®ƒä»¬ã€‚å¤§å®¶ç•™ä¸ªæ˜ è±¡çœ‹åé¢çš„æ“ä½œã€‚å¯¹åº”çš„ç›®å½•æ˜¯ï¼š`\system\framework`

![](http://upload-images.jianshu.io/upload_images/1110736-b714d2482d1be616.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
æˆ‘ä»¬å¯ä»¥çœ‹åˆ°é‡Œé¢å¹¶æ²¡æœ‰åŒ…å«`dex`æ–‡ä»¶ï¼Œåªæœ‰`res`å’Œ`assets`èµ„æºæ–‡ä»¶ã€‚

-----

## é€†å‘å·¥å…·ç®±
ä¸‹é¢æˆ‘ä»¬ä¸€èµ·æ¥çœ‹ä¸€ä¸‹ç°åœ¨ä¸»æµçš„åç¼–è¯‘å·¥å…·ï¼Œæˆ‘ä¼šä¾ä¾ç®€å•ä»‹ç»ã€‚

- baksmali
`baksmali`ç”¨äºå°†`odex`è§£ææˆ`smali`çš„å·¥å…·ã€‚å¯èƒ½æ”¹ä¸ªåå­—å«ï¼ˆ`odex2dex`æ›´åˆé€‚ï¼‰

- dex2jar
 å°†dexè½¬æ¢æˆjaræ–‡ä»¶ã€‚

- gd-gui

åç¼–è¯‘æ•´ä¸ª`jar`å¯ä»¥å¯¹æŠŠsmaliæ–‡ä»¶è§£ææˆ`java`æºç æŸ¥çœ‹çš„ä¸€æ¬¾å·¥å…·ã€‚

- apktools
æ‹¥æœ‰å¯¹`apk`ç¼–è¯‘ã€åç¼–è¯‘ã€ç­¾åç­‰åŠŸèƒ½ã€‚

- SVADeodexerForArt
è‡ªåŠ¨åˆå¹¶æ¡†æ¶å·¥å…·ï¼Œå¯ä»¥é€šè¿‡ç®€å•çš„é…ç½®ï¼Œå°±å¯ä»¥åˆå¹¶å‡º`rom`é‡Œçš„`app`å’Œ`odex`æ–‡ä»¶ã€‚

- apkDB
ä¸­æ–‡åç§°å®‰å“é€†æ‰‹ï¼Œæ•´åˆäº†åç¼–è¯‘å¤šæ¬¾å·¥å…·çš„ä¸€ä¸ªå·¥å…·é›†åˆï¼ŒåŠŸèƒ½å¾ˆå¼ºå¤§ï¼Œå‡ ä¹ä½ æƒ³è¦çš„ä¸€åˆ‡æ“ä½œéƒ½èƒ½åœ¨é‡Œé¢æ‰¾åˆ°å¯¹åº”çš„å·¥å…·å‘½ä»¤ã€‚

- å½“å‰Activity
è¿™æ˜¯ä¸€æ¬¾appåº”ç”¨ï¼Œç”¨äºæ˜¾ç¤ºå½“å‰æ‰‹æœºç•Œé¢ä¸Šçš„`Activity`ç­‰åŒ…åä¿¡æ¯ã€‚


**å·¥å…·ä¸‹è½½åœ°å€ï¼š**
**[baksmali](https://github.com/JesusFreke/smali)**
 **[dex2jar](https://github.com/pxb1988/dex2jar)**
**[JD-GUI](http://www.softpedia.com/get/Programming/Debuggers-Decompilers-Dissasemblers/JD-GUI.shtml)**
**[Apktool](https://ibotpeaches.github.io/Apktool/)**
**[SVADeodexerForArt](http://htcui.com/download.php?id=7791)**
**[apkDB](https://www.idoog.cn/?p=2933)**
**[å½“å‰Activity](https://play.google.com/store/apps/details?id=com.willme.topactivity&hl=zh_CN)** (éœ€è¦è¿‡å¢™)

-----

## å®æˆ˜é€†å‘MIUIç³»ç»Ÿè®¾ç½®WIFI

å‰é¢çš„çŸ¥è¯†æ¯”è¾ƒæ‰æ‚ï¼Œä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®é™…æ¡ˆåˆ—æ¥åˆ†æå…·ä½“romé€†å‘è¿‡ç¨‹ã€‚

- éœ€æ±‚

 æˆ‘ä»¬æœ‰ä¸€ä¸ªè¿™æ ·çš„éœ€æ±‚ï¼Œéœ€è¦åœ¨åº”ç”¨å†…åˆ‡æ¢WIFIã€‚
è¿™ä¸ªéœ€æ±‚å¾ˆæ™®é€šå¾ˆæ­£å¸¸å§ï¼Ÿæ²¡é”™ï¼Œæˆ‘ä¹Ÿæ˜¯è¿™æ ·æƒ³çš„ã€‚ä½†æ˜¯å‘¢ï¼Œä¸ä¹…ä½ å°±ä¼šå‘ç°éƒ¨åˆ†å°ç±³é«˜ç‰ˆæœ¬æœºå‹åˆ‡æ¢wifiçš„APIè°ƒç”¨äº†ä¸èµ·ä½œç”¨ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€çœ¼ä»£ç ã€‚

https://developer.android.com/reference/android/net/wifi/WifiManager.html
![](http://upload-images.jianshu.io/upload_images/1110736-fc3e805ac42db49e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

è¿™æ˜¯å®˜æ–¹æä¾›çš„åˆ‡æ¢çƒ­ç‚¹çš„APIã€‚

![](http://upload-images.jianshu.io/upload_images/1110736-1d41f28648ab2023.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
æˆ‘ä»¬æ‹¿èµ·æ¥ç›´æ¥è°ƒç”¨äº†ã€‚è¿™ä¸€åˆ‡éƒ½çœ‹ä¼¼æ­£å¸¸ã€‚å¯å°±æ˜¯åœ¨å°ç±³ä¸Šå‡ºç°è¿™ç§é—®é¢˜ã€‚é‡åˆ°è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å…ˆé™ä¸‹å¿ƒæ¥åˆ†æä¸‹ã€‚

é™¤äº†å°ç±³è¿˜æœ‰åˆ«çš„æœºå‹ä¹Ÿæœ‰é—®é¢˜ï¼Ÿ
è·Ÿandroidç‰ˆæœ¬ä¹Ÿæœ‰å…³ç³»ï¼ŒAPIé«˜ç‰ˆæœ¬å˜æ›´ï¼Ÿ


ç¬¬ä¸€ä¸ªé—®é¢˜å¯ä»¥æš‚æ—¶æ’é™¤æ”¾ä¸€è¾¹ï¼Œèƒ½æµ‹çš„éƒ½æµ‹äº†éƒ½æ²¡æ¯›ç—…ï¼Œä¸Šäº‘æµ‹å¹³å°ä¹Ÿè¯•è¿‡äº†ã€‚


ç¬¬äºŒä¸ªé—®é¢˜å…³äºå˜æ›´æƒ…å†µã€‚ä¸‹é¢æ˜¯å®˜æ–¹æ–‡æ¡£ï¼Œ6.0WLANçš„å˜æ›´æƒ…å†µã€‚

![](http://upload-images.jianshu.io/upload_images/1110736-51050b0dea2c04c9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

**æ³¨æ„ï¼š**æˆ‘ç¿»è¯‘ä¸‹ï¼Œå®˜æ–¹çš„æ„æ€æ˜¯è¯´ç”±ç”¨æˆ·æ‰‹åŠ¨åˆ›å»ºå’Œå…¶ä»–appåˆ›å»ºçš„`WifiConfiguration`é…ç½®ä¿¡æ¯æ˜¯ä¸èƒ½è¢«æˆ‘ä»¬ä¿®æ”¹çš„ã€‚æ˜ç™½äº†å—ï¼Ÿå’Œåˆ‡æ¢æ²¡æœ‰ä»€ä¹ˆå…³ç³»ã€‚å› ä¸ºæˆ‘ä»¬ä¸ä¿®æ”¹ï¼Œåªæ˜¯è¿æ¥åˆ‡æ¢æ“ä½œã€‚

- æ€è·¯

è¿™ä¸‹å°±æ¯”è¾ƒæ“è›‹äº†ï¼Œæ—¢ç„¶`api`æ²¡æœ‰åšåˆ‡æ¢é™åˆ¶ä¸ºä½•ä¸èƒ½åˆ‡`wifi`ã€‚å¸¦ç€è¿™ä¸ªç–‘é—®æˆ‘æƒ³äº†æƒ³åˆ«å®¶çš„åº”ç”¨æ˜¯å¦‚ä½•åšçš„å‘¢ï¼Ÿæ¯”å¦‚WIFIä¸‡èƒ½é’¥åŒ™ã€‚æˆ‘å¦‚æœåç¼–è¯‘ä»–ä»¬å®¶çš„APPä¼šè¢«åŠ å£³å’Œä»£ç æ··æ·†çš„ã€‚ï¼ˆå…¶å®æˆ‘å°è¯•è¿‡äº†ï¼Œä½†æ²¡æœ‰è„±å¼€ã€‚ï¼‰

æƒ³é—®é¢˜æ‰äº†ä¸€åœ°å¤´å‘åï¼Œæœ€åæˆ‘æƒ³åˆ°äº†ä¸ºä»€ä¹ˆç³»ç»Ÿçš„è®¾ç½®ä»–è‡ªå·±åˆèƒ½åˆ‡ï¼Ÿæ˜¯ä¸æ˜¯æœ‰éšè—çš„`API`è°ƒç”¨ã€‚å°±è¿™æ ·åŠçŒœæµ‹ï¼ŒåŠæ€€ç–‘çš„æ€åº¦å»æ‰“ç®—æäº‹æƒ…äº†ã€‚é¦–å…ˆå¾—å»æ‹¿åˆ°ç³»ç»Ÿè®¾ç½®APPçš„æºç å§ï¼Ÿæˆ‘å¾—åç¼–è¯‘å›æ¥`rom`é‡Œçš„è®¾ç½®APPã€‚

è¯´ä¸€ä¸ªå°æ’æ›²ï¼šæ–‡ç« é‡Œçœ‹èµ·æ¥è¿˜ç®—é¡ºç•…ï¼Œä½†æ˜¯å®é™…æ“ä½œçš„æ—¶å€™å„ç§è‰°éš¾é™©é˜»ã€‚é—®é¢˜é‡é‡ã€‚åœ¨APKå¯¼å‡ºç³»ç»Ÿè®¾ç½®ç¨‹åºè¿™é‡Œæµªè´¹äº†ä¸å°‘æ—¶é—´ï¼Œä¸€ç›´å¤©çœŸçš„è®¤ä¸ºç³»ç»Ÿçš„apkä¹Ÿèƒ½ç›´æ¥å¯¼å‡ºæ¥åç¼–è¯‘çš„ã€‚ç»“æœæ˜¯å‹æ ¹ä¸çŸ¥é“`odex`ä¼˜åŒ–äº†ã€‚ï¼ˆä»€ä¹ˆä½ ä¹Ÿä¸çŸ¥é“`odex`ä¼˜åŒ–ï¼Ÿè¯´æ˜ä½ æ²¡æœ‰çœ‹æˆ‘å‰é¢ç« èŠ‚è®²åˆ°çš„ä¸œè¥¿ã€‚ï¼‰

- å¯»æ‰¾åˆ‡å…¥ç‚¹

è¿™é‡Œæˆ‘ä»¬ä¸€æ­¥æ­¥æ¥ï¼Œé¦–å…ˆæ‰“å¼€ç³»ç»Ÿè®¾ç½®ï¼Œè·³è½¬åˆ°WIFIè®¾ç½®ç•Œé¢ã€‚
å®ƒæ˜¯é…±æ ·å­çš„ã€‚

![](http://upload-images.jianshu.io/upload_images/1110736-1ab716a957afeac6.png?imageMogr2/auto-orient/strip%7CimageView2/2/h/400)

æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦çŸ¥é“è¿™ä¸ª`Activity`çš„åŒ…åå’Œ`fragment`çš„å«ä»€ä¹ˆã€‚
æ‰“å¼€Android ADB shell
è¾“å…¥ï¼š**`dumpsys activity top`**
å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ™°çš„çœ‹åˆ°æˆ‘ä»¬éœ€è¦çš„ä¿¡æ¯ã€‚
**Activity:** com.android.settings.SubSettings
**Fragment:** MiuiWifiSettings
![](http://upload-images.jianshu.io/upload_images/1110736-5932dd50ae4d8312.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

ä¸€ä¼šå„¿æˆ‘ä»¬åç¼–è¯‘åçš„`App`å°±å¯ä»¥é€šè¿‡åŒ…å+åç§°æ¥æ‰¾åˆ°å¯¹åº”çš„åˆ‡æ¢wifiä»£ç æ¥ã€‚
è¿™é‡Œé™¤äº†ä½¿ç”¨`adb shell `çš„æ–¹å¼è¿˜å¯ä»¥ç”¨ å½“å‰`Activity App` è¿›è¡ŒæŸ¥çœ‹ï¼Œåªä¸è¿‡ä¿¡æ¯æ²¡æœ‰è¿™ä¹ˆå…¨é¢ã€‚

- ä¸‹è½½å›ºä»¶

æˆ‘ä»¬æ‰¾åˆ°MIUIå®˜ç½‘ï¼Œä¸‹è½½ç¨³å®šç‰ˆçš„å›ºä»¶å°±è¡Œäº†ã€‚

http://www.miui.com/download.html

è¿™é‡Œæˆ‘ç”¨çš„æ˜¯ç±³max

![](http://upload-images.jianshu.io/upload_images/1110736-6b3e7515c8833916.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

ä¸‹è½½åï¼Œæˆ‘ä»¬ç›´æ¥è§£å‹å³å¯ï¼Œå®ƒæ˜¯é…±æ ·çš„ã€‚

![](http://upload-images.jianshu.io/upload_images/1110736-1ee1a86a9e36cad3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

- æ‹†åŒ…ä¸åˆå¹¶èµ„æº

æˆ‘ä»¬å…ˆæ¥æ‰¾ä¸€ä¸‹SettingsAppçš„è·¯å¾„ã€‚
è¿™é‡Œæˆ‘å·²ç»æ‰¾å¥½äº†ï¼Œè·¯å¾„æ˜¯ï¼š`\system\priv-app\Settings\`

å¦‚æœä½ æƒ³é—®æˆ‘ï¼Œæ€ä¹ˆçŸ¥é“çš„è·¯å¾„çš„ï¼Ÿ
ç½‘ä¸Šæœå‘€ï¼Œè‡ªå·±ç¿»ç›®å½•å“‡ï¼Œç¿»çƒ‚äº†å°±å‡ºæ¥å•¦ã€‚
å™¢ï¼Œå¯¹äº†ï¼Œåœ¨windowsä¸‹æœ‰ä¸€æ¬¾å«Everythingçš„ç¥å™¨ä¹Ÿå¯ä»¥è¯•è¯•ï¼Œè¶…å¥½ç”¨çš„ã€‚


  æˆ‘ä»¬æ‰“å¼€SVADeodexerForArtè‡ªåŠ¨åˆå¹¶æ¡†æ¶å·¥å…·ã€‚
é€‰æ‹©æˆ‘ä»¬è§£å‹å¥½çš„ç›®å½•è‡³systemä¸‹ã€‚ä¾æ¬¡å…¨éƒ¨å‹¾é€‰ä¸‹é¢ä¸‰ä¸ªé€‰é¡¹ï¼Œç‚¹å‡»Executeåå°±ä¼šå‡ºç°ä¸‹é¢è¿™å¹…å›¾çš„æ ·å­ï¼Œåªéœ€è¦é™é™ç­‰å¾…å‡ åˆ†é’Ÿå°±å¯ä»¥äº†ã€‚ä»–ä¼šå°†odexèµ„æºä¸apkè¿›è¡Œåˆå¹¶ã€‚
![](http://upload-images.jianshu.io/upload_images/1110736-25aea0aefc55bae8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

æ³¨æ„åˆå¹¶odexä¸æ­¢è¿™ä¸€ç§æ–¹å¼ï¼Œè¿™æ˜¯ç›®å‰ä¸ºæ­¢æœ€ç®€å•ï¼Œæœ€å‚»ç“œçš„æ“ä½œæ–¹å¼ã€‚
è¯»è€…å¦‚æœæœ‰éœ€è¦æ·±ç©¶å¯ä»¥å°è¯•`baksmali.jar+ smali.jar +apktools`è¿›è¡Œæˆ–è€…apkDBå›ç¼–ã€‚å·¥å…·ä¸‹è½½åœ°å€åœ¨ä¸Šä¸ªç« èŠ‚æœ‰ç»™å‡ºã€‚

ä½¿ç”¨åˆ—å­å¦‚ä¸‹ï¼š
```
java -jar baksmali.jar -d ./system/framework -x Settings.odex
java -jar smali.jar classout/ -o classes.dex
```
å› ä¸ºå¾ˆéº»çƒ¦ï¼Œæœ‰å¾ˆå¤šå‘ï¼Œæˆ‘è¸©äº†å¾ˆå¤šæ¬¡ã€‚ä¸»è¦ä¸¤ä¸ªé—®é¢˜ï¼š
1.æ¡†æ¶æ–‡ä»¶ä¸é½å…¨æ‰¾ä¸åˆ°
2.smaliå›ç¼–æŠ›å‡ºå¥‡å¥‡æ€ªæ€ªçš„å¼‚å¸¸ï¼Œå¥½åƒå’Œä»£ç æ··æ·†è¿˜æœ‰å…³ç³»ï¼Œå› ä¸ºæœ‰ä¸€äº›æš—æ¡©ä»£ç 
ç›®å‰æˆ‘ä¹Ÿä¸çŸ¥é“æ€ä¹ˆè§£å†³ï¼Œç½‘ä¸Šä¹Ÿæ²¡æœ‰æ‰¾åˆ°å¯å‚è€ƒçš„èµ„æ–™ï¼Œæ‰€ä»¥æˆ‘æ¨èå¤§å®¶ç›´æ¥ç”¨SVADeodexerForArtå°±å¥½äº†ï¼Œåˆ«è´¹é‚£ä¸ªäº‹æµªè´¹æ—¶é—´ã€‚


å¥½è¨€å½’äºå¥½ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æ‰§è¡Œå®Œåç”Ÿæˆçš„ç›®å½•ï¼š

ä¼šåœ¨å½“å‰å·¥å…·ä¸‹çš„æ ¹ç›®å½•ä¸Šoutå‡ºä»¥ä¸‹å‡ ä¸ªæ–‡ä»¶å¤¹ï¼Œè¿™é‡Œåˆ†åˆ«åŒ…å«ç³»ç»Ÿframeworkã€UIã€é¢„è£…APPå’Œç³»ç»ŸAPPã€‚
![](http://upload-images.jianshu.io/upload_images/1110736-b7c32b6b27f207fb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

è¿™é‡Œæˆ‘ä»¬é‡ç‚¹å…³æ³¨`SettingsApp`ï¼Œæ‰“å¼€`priv-app\Settings`,å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ä¸Šé¢çš„æ˜¯åˆå¹¶åçš„13905kbï¼Œä¸‹é¢æ˜¯åˆå¹¶ä¹‹å‰çš„12370kbã€‚è¿™é‡Œå°±å¯ä»¥çœ‹å‡ºå·²ç»åˆå¹¶æˆåŠŸäº†ã€‚
![](http://upload-images.jianshu.io/upload_images/1110736-0fae04edc0b22c00.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

æˆ‘ä»¬ç”¨å‹ç¼©å·¥å…·çœ‹ä¸€çœ¼ï¼š


![](http://upload-images.jianshu.io/upload_images/1110736-abb884d791b47a31.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

å¾ˆæ˜æ˜¾å·²ç»åˆå¹¶æˆåŠŸäº†å™¢ã€‚
ä¸‹é¢æˆ‘ä»¬ä½¿ç”¨`ApkTools`åç¼–è¯‘è¿‡æ¥æŸ¥çœ‹ã€‚

ä½¿ç”¨ `ApkTools `è¾“å…¥å‘½ä»¤ï¼š`apktool.bat d -f Settings.apk` ï¼ˆæ³¨æ„Settings.apkçš„è·¯å¾„ï¼Œæˆ‘è¿™é‡Œæ˜¯æ‹·è´åˆ°äº†apktool åŒä¸€ä¸ªç›®å½•ä¸‹ï¼‰

![](http://upload-images.jianshu.io/upload_images/1110736-e57dd40a8628b692.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

å¯¹åº”ä¼šç”Ÿæˆä¸€ä¸ªåŒåçš„æ–‡ä»¶å¤¹å«Settingsï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€çœ¼é‡Œé¢æœ‰ä»€ä¹ˆ

![](http://upload-images.jianshu.io/upload_images/1110736-dfa99937f3f0d330.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

ç®€ç›´å®Œç¾ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°`smali`æ–‡ä»¶å¤¹å‡ºç°äº†ã€‚æˆ‘ä»¬ç°åœ¨è¦åšçš„å°±å°†`smali`æ–‡ä»¶åˆå¹¶æˆ`dex`ã€‚

ç»§ç»­ä¸‹ä¸€æ­¥
ä½¿ç”¨smali.jarå·¥å…·
å‘½ä»¤ï¼š`  java -jar smali-2.1.3.jar ./Settings/smali/ -o setting.dex`

![440765BBCB9145882A58EF3A2D4CD58F.png](http://upload-images.jianshu.io/upload_images/1110736-12563548f2dc5c67.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

å°†ç”Ÿæˆdexæ–‡ä»¶ï¼š

![](http://upload-images.jianshu.io/upload_images/1110736-f32f4e63e8af08ce.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

åˆ«æ€¥å°±å¿«çœ‹åˆ°æºç äº†ã€‚é©¬ä¸Šï¼Œæˆ‘ä¿è¯ã€‚

ä½¿ç”¨**[dex2jar](https://github.com/pxb1988/dex2jar)**å·¥å…·ï¼Œå°†dexè½¬jarã€‚

è¾“å…¥ï¼š`d2j-dex2jar.bat Settings.dex`
å¾—åˆ° `settings-dex2jar.jar`

![](http://upload-images.jianshu.io/upload_images/1110736-4d1a1837b99e2e9a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

æˆ‘ä»¬æ‰“å¼€jd-juiå·¥å…·ï¼Œå°†jaræ‹½å…¥åŠ è½½æ‰“å¼€ã€‚

![](http://upload-images.jianshu.io/upload_images/1110736-0f795a0cb5e205da.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

è‡³æ­¤ï¼Œæˆ‘ä»¬å°±æ‹¿åˆ°äº†æºç ã€‚å¥½ï¼Œæˆ‘ä»¬ç¨å¾®æ•´ç†ä¸€ä¸‹ã€‚ä¸€ä¼šå„¿ä¸€èµ·æ¥çœ‹æºç ã€‚

1.ä¸‹è½½romåŒ…
2.-->è§£å‹
3.--> `SVADeodexerForArt`åˆå¹¶`odex`
4.-->` apktools`åç¼–è¯‘
5.-->`smali.jar`æ‰“åŒ…`smali`æˆ`dex`
6.-->`dex2jar.jar`è½¬æ¢` dex`æˆ`jar`
7.-->`jd-jui`å·¥å…·åŠ è½½jaræŸ¥çœ‹

è‡³æ­¤ä¸€å…±ä¸ƒä¸ªæ­¥éª¤ï¼Œå…¶å®è¿™ä¸ªæ“ä½œå¹¶ä¸éš¾ï¼Œåªæ˜¯éœ€è¦å€ŸåŠ©å¤šæ¬¾å·¥å…·æ¥å®Œæˆå°±ç•¥æ˜¾æ­¥éª¤å¤æ‚ã€‚ç„¶åä¸­é—´å¯èƒ½ä¼šæœ‰äº›å°å‘ï¼Œå¡ä½çš„è¯å°±å®¹æ˜“è®©äººå¤±å»ä¿¡å¿ƒã€‚æ–°æ‰‹åˆ«å»å¼ºè®°è¿™äº›ï¼Œç”¨å¤šäº†å°±è‡ªç„¶å°±ç†Ÿæ‚‰äº†ã€‚

- ç¿»æºç 
å¥½ï¼Œè¿˜è®°å¾—æˆ‘å—çš„éœ€æ±‚å—ï¼Ÿéœ€è¦åœ¨åº”ç”¨å†…åˆ‡æ¢`wifi`ã€‚ä½†æ˜¯å°ç±³å†…æ— æ•ˆã€‚
å—¯ï¼Œç°åœ¨æˆ‘ä»¬æœ‰æºç äº†ï¼Œæ¥ï¼Œä¸€èµ·æ¥çœ‹çœ‹ç³»ç»Ÿæ€ä¹ˆåšçš„å§ã€‚
è¿™æ˜¯æˆ‘ä»¬ä¹‹å‰å¯»æ‰¾åˆ‡å…¥ç‚¹æ‹¿åˆ°çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬ç›´æ¥é€šè¿‡jd-juiåˆ‡å…¥æºç ã€‚

**Activity:** com.android.settings.SubSettings
**Fragment:** MiuiWifiSettings

![](http://upload-images.jianshu.io/upload_images/1110736-81f89ba9c3ae8417.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

è¿™é‡Œæˆ‘ä»¬å‘ç°é‡Œé¢ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œå”¯ä¸€æœ‰ç”¨çš„æ˜¯å®ƒç»§æ‰¿äº†`iy`ï¼Œæ²¡çŒœé”™çš„è¯iyä¸€å®šæ˜¯ä¸€ä¸ª`Activity`ï¼Œè¿™é‡Œåº”è¯¥æ˜¯è¢«æ··æ·†äº†ï¼Œæˆ‘ä»¬ç‚¹è¿›å»çœ‹ã€‚

![](http://upload-images.jianshu.io/upload_images/1110736-f6754c45d68de4d9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
å¯ä»¥å‘ç°é‡Œé¢æ¯”ä¹‹å‰é‚£å±‚å£³é‡Œçš„å†…å®¹ä¸°å¯Œå¤šäº†ï¼Œè¿˜è®°å¾—æˆ‘ä»¬ä¹‹å‰åˆ†æè¿‡é‚£é‡Œä¸æ˜¯`Activity`ç›´æ¥å±•ç¤ºçš„è€Œç”¨äº†`fragment`æˆ‘ä»¬æœç´¢ä¸€ä¸‹`MiuiWifiSettings`ã€‚æœç„¶å­˜åœ¨è¿™é‡Œã€‚

ç»§ç»­ç‚¹è¿‡å»ã€‚

![](http://upload-images.jianshu.io/upload_images/1110736-f53d4aeabbc55329.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

å‘ç°åˆæ˜¯ä¸€ä¸ªç©ºå£³å­ï¼Œæˆ‘ä»¬ç›´æ£é»„é¾™æ·±å…¥ä¸€ç‚¹çœ‹çˆ¶ç±»ã€‚

![](http://upload-images.jianshu.io/upload_images/1110736-87d037a199a4710c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

æœä¸å…¶ç„¶ï¼ŒæŒæœ‰äº†`WifiManager `å¯¹è±¡ï¼Œè¿™å°±æ˜¯ç”¨æ¥ç®¡ç†wifiçš„å¯¹è±¡ã€‚

![](http://upload-images.jianshu.io/upload_images/1110736-9760802cb374bbb7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

æˆ‘ä»¬çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å¤„ç†`wifi`åˆ‡æ¢çš„ï¼Œæœ€ç»ˆå‘ç°`jn.connect`æ–¹æ³•ã€‚çœ‹åˆ°æ²¡æœç„¶æœ‰è‡ªå·±ä¸€å¥—ã€‚æ­»æ´»åˆ‡ä¸è¿‡å»ï¼ŒåŸæ¥æ˜¯æœ‰éšè—`api`è°ƒç”¨çš„ã€‚è€Œ`sdk`å±‚å¹¶æ²¡æœ‰æš´éœ²å‡ºæ¥ï¼Œè°·æ­Œå®˜æ–¹å¼€å‘æ–‡æ¡£ä¸­ä¹Ÿä¸å­˜åœ¨è¿™ä¸ªæ–¹æ³•ã€‚

![](http://upload-images.jianshu.io/upload_images/1110736-4cb41685d15cfd39.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/200)

å¥½æ°”å“¦ï¼Œå±…ç„¶å·æ‘¸è°ƒç”¨ä¸€ä¸‹ï½ï½


- åå°„API

å¥½ï¼Œæ—¢ç„¶çŸ¥é“äº†æ˜¯ä½¿ç”¨äº†éšè—apiæˆ‘ä»¬å¯ä»¥ç”¨åå°„æ¥è§£å†³ï¼Œä»£ç å¦‚ä¸‹ã€‚

``` java
Class cls = mWifiManager.getClass();
  Method method = cls.getDeclaredMethod("connect", WifiConfiguration.class, Class.forName("android.net.wifi.WifiManager$ActionListener"));
        method.invoke(mWifiManager, mWifiConfiguration, null);
```

è¿™æ ·æˆ‘ä»¬çš„ç–‘é—®å°±è§£å†³äº†ï¼Œæµ‹è¯•åœ¨miuiä¸Šé€šè¿‡ã€‚

åˆ°è¿™é‡Œæˆ‘ä»¬çš„å®æˆ˜å°±å®Œæˆäº†ã€‚ä»¥åéº»éº»å†ä¹Ÿä¸ç”¨æ‹…å¿ƒå‚å•†æ”¹äº†ã€‚é¡¶å¤šæˆ‘ä»¬éº»çƒ¦ä¸€ä¸¢ä¸¢å•¦ã€‚ä¸è‡³äºå¡ä½å®Œå…¨è¢«åŠ¨çš„æƒ…å†µã€‚


## åè®°

å¯¹ä¸èµ·ï¼Œæˆ‘éª—äº†å¤§å®¶ã€‚æˆ‘æ˜¯ä¸€ä¸ªå¤§éª—çº¸ã€‚å…¶å®è¿™ä¸ª`api`ä¸æ˜¯å°ç±³ç§æœ‰çš„ï¼Œæ˜¯ç³»ç»Ÿéšè—APIã€‚åªæ˜¯è¯´å¸¸è§„çš„åˆ‡æ¢æ–¹å¼åœ¨å°ç±³ä¸Šæ— æ•ˆã€‚æ­£å¥½å°ç±³çš„  `Settings`å†…éƒ¨ç”¨çš„æ˜¯`connect`æ–¹æ³•ç³»ç»Ÿéšè—`Api`ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€çœ¼  `WifiManager `å®˜æ–¹æºç ã€‚
https://android.googlesource.com/platform/frameworks/base/+/refs/heads/master/wifi/java/android/net/wifi/WifiManager.java

![](http://upload-images.jianshu.io/upload_images/1110736-e1028421f5db15c3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

æˆ‘çœŸçš„å¥½å®³æ€•å°ç±³çš„å·¥ç¨‹å¸ˆçœ‹åˆ°äº†è¿™ç¯‡æ–‡ç« ä»¥åï¼Œè¡¨ç¤ºè¿™ä¸ªé”…ï¼Œæˆ‘ä»¬ä¸èƒŒã€‚æ‰€ä»¥è¿™é‡Œè¦æ¾„æ¸…ä¸€ä¸‹ã€‚

ç„¶åå¤§å®¶çš„é‡ç‚¹ä¸è¦çº ç»“è¿™ä¸ª`API`å•¦ï¼Œæ€è·¯ï¼Œæ€è·¯ï¼Œæ€è·¯å¾ˆé‡è¦ã€‚å…³é”®æ˜¯é€†å‘`rom`å±‚å¸¦æ¥çš„ä¾¿åˆ©çœŸçš„ä¸æ˜¯ä¸€ç‚¹åŠç‚¹çš„ã€‚å‡ ä¹å¯ä»¥è§£å†³ç»å¤§éƒ¨åˆ†å› ä¸ºå‚å•†æ”¹åŠ¨å¯¼è‡´ä»£ç ç¢ç‰‡åŒ–å¸¦æ¥çš„ç–‘éš¾æ‚ç—‡ã€‚å¸Œæœ›æœ¬æ–‡èƒ½ç»™å¹¿å¤§çš„åº”ç”¨å±‚å¼€å‘è€…æä¾›ä¸€ä¸å¸®åŠ©ï¼Œè¯¶å‘¦ï¼Œæˆ‘å°±è¶…å¼€å¿ƒçš„ã€‚ğŸ™


---
# å¦‚ä½•ä¸‹æ¬¡æ‰¾åˆ°æˆ‘?
- å…³æ³¨æˆ‘çš„ç®€ä¹¦
- æœ¬ç¯‡åŒæ­¥Githubä»“åº“:[https://github.com/BolexLiu/MyNote](https://github.com/BolexLiu/MyNote)Â  (å¯ä»¥å…³æ³¨)
![](http://upload-images.jianshu.io/upload_images/1110736-f0a700624e0723ae.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

**åŸåˆ›æ–‡ç« ï¼Œæœªæˆæƒç¦æ­¢è½¬è½½ã€‚**